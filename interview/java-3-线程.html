<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>线程 | JavaChen Wiki</title>
    <meta name="description" content="JavaChen Wiki">
    <link rel="icon" href="/wiki/img/logo.ico">
  <meta http-quiv="pragma" cotent="no-cache">
  <meta http-quiv="pragma" cotent="no-cache,must-revalidate">
  <meta http-quiv="expires" cotent="0">
    
    <link rel="preload" href="/wiki/assets/css/0.styles.bdf32acf.css" as="style"><link rel="preload" href="/wiki/assets/js/app.dd178f5a.js" as="script"><link rel="preload" href="/wiki/assets/js/2.9f273a62.js" as="script"><link rel="preload" href="/wiki/assets/js/31.dde8666e.js" as="script"><link rel="prefetch" href="/wiki/assets/js/10.e389070d.js"><link rel="prefetch" href="/wiki/assets/js/11.19e9f97f.js"><link rel="prefetch" href="/wiki/assets/js/12.f95e0459.js"><link rel="prefetch" href="/wiki/assets/js/13.127730fd.js"><link rel="prefetch" href="/wiki/assets/js/14.34eed2f7.js"><link rel="prefetch" href="/wiki/assets/js/15.a8cf4000.js"><link rel="prefetch" href="/wiki/assets/js/16.6346731c.js"><link rel="prefetch" href="/wiki/assets/js/17.143af375.js"><link rel="prefetch" href="/wiki/assets/js/18.7d95703a.js"><link rel="prefetch" href="/wiki/assets/js/19.8726bd0b.js"><link rel="prefetch" href="/wiki/assets/js/20.2914a04f.js"><link rel="prefetch" href="/wiki/assets/js/21.ebd751e0.js"><link rel="prefetch" href="/wiki/assets/js/22.f6801be0.js"><link rel="prefetch" href="/wiki/assets/js/23.87ecfe73.js"><link rel="prefetch" href="/wiki/assets/js/24.cabcaf93.js"><link rel="prefetch" href="/wiki/assets/js/25.306828f5.js"><link rel="prefetch" href="/wiki/assets/js/26.59450304.js"><link rel="prefetch" href="/wiki/assets/js/27.44fddb85.js"><link rel="prefetch" href="/wiki/assets/js/28.4e15bea1.js"><link rel="prefetch" href="/wiki/assets/js/29.bed7cbfd.js"><link rel="prefetch" href="/wiki/assets/js/3.28138f41.js"><link rel="prefetch" href="/wiki/assets/js/30.36a67cca.js"><link rel="prefetch" href="/wiki/assets/js/32.148ea73a.js"><link rel="prefetch" href="/wiki/assets/js/33.61c937cc.js"><link rel="prefetch" href="/wiki/assets/js/34.eb7c4b0c.js"><link rel="prefetch" href="/wiki/assets/js/35.abb4ce3d.js"><link rel="prefetch" href="/wiki/assets/js/36.f03d0378.js"><link rel="prefetch" href="/wiki/assets/js/37.84491176.js"><link rel="prefetch" href="/wiki/assets/js/38.2a06b872.js"><link rel="prefetch" href="/wiki/assets/js/39.63965d3b.js"><link rel="prefetch" href="/wiki/assets/js/4.c0af9872.js"><link rel="prefetch" href="/wiki/assets/js/40.bf2e354a.js"><link rel="prefetch" href="/wiki/assets/js/41.bed53451.js"><link rel="prefetch" href="/wiki/assets/js/42.34d4f2f5.js"><link rel="prefetch" href="/wiki/assets/js/43.867c0e23.js"><link rel="prefetch" href="/wiki/assets/js/44.0201a314.js"><link rel="prefetch" href="/wiki/assets/js/45.d6f1a311.js"><link rel="prefetch" href="/wiki/assets/js/46.419d44e4.js"><link rel="prefetch" href="/wiki/assets/js/47.a3f8b595.js"><link rel="prefetch" href="/wiki/assets/js/48.574cc219.js"><link rel="prefetch" href="/wiki/assets/js/49.224dd6c4.js"><link rel="prefetch" href="/wiki/assets/js/5.c521f8b1.js"><link rel="prefetch" href="/wiki/assets/js/50.c8825040.js"><link rel="prefetch" href="/wiki/assets/js/51.2dab614a.js"><link rel="prefetch" href="/wiki/assets/js/52.8382a180.js"><link rel="prefetch" href="/wiki/assets/js/53.bfab18a9.js"><link rel="prefetch" href="/wiki/assets/js/54.87a1d37c.js"><link rel="prefetch" href="/wiki/assets/js/55.5f207671.js"><link rel="prefetch" href="/wiki/assets/js/56.f0e8e082.js"><link rel="prefetch" href="/wiki/assets/js/57.c868e5c9.js"><link rel="prefetch" href="/wiki/assets/js/6.6a737c5b.js"><link rel="prefetch" href="/wiki/assets/js/7.48bba6b4.js"><link rel="prefetch" href="/wiki/assets/js/8.26532964.js"><link rel="prefetch" href="/wiki/assets/js/9.3c4a4032.js">
    <link rel="stylesheet" href="/wiki/assets/css/0.styles.bdf32acf.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/wiki/" class="home-link router-link-active"><!----> <span class="site-name">JavaChen Wiki</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/wiki/" class="nav-link">主页</a></div><div class="nav-item"><a href="/wiki/docker/" class="nav-link">Docker</a></div><div class="nav-item"><a href="/wiki/elasticsearch/" class="nav-link">Elasticsearch</a></div><div class="nav-item"><a href="/wiki/hadoop/" class="nav-link">Hadoop</a></div><div class="nav-item"><a href="/wiki/interview/" class="nav-link router-link-active">Interview</a></div><div class="nav-item"><a href="/wiki/rabbitMQ/" class="nav-link">RabbitMQ</a></div><div class="nav-item"><a href="/wiki/redis/" class="nav-link">Redis</a></div><div class="nav-item"><a href="/wiki/spring-cloud-cshop/" class="nav-link">Spring-cloud-cshop</a></div><div class="nav-item"><a href="/wiki/about.html" class="nav-link">关于</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/wiki/" class="nav-link">主页</a></div><div class="nav-item"><a href="/wiki/docker/" class="nav-link">Docker</a></div><div class="nav-item"><a href="/wiki/elasticsearch/" class="nav-link">Elasticsearch</a></div><div class="nav-item"><a href="/wiki/hadoop/" class="nav-link">Hadoop</a></div><div class="nav-item"><a href="/wiki/interview/" class="nav-link router-link-active">Interview</a></div><div class="nav-item"><a href="/wiki/rabbitMQ/" class="nav-link">RabbitMQ</a></div><div class="nav-item"><a href="/wiki/redis/" class="nav-link">Redis</a></div><div class="nav-item"><a href="/wiki/spring-cloud-cshop/" class="nav-link">Spring-cloud-cshop</a></div><div class="nav-item"><a href="/wiki/about.html" class="nav-link">关于</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Interview</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/wiki/interview/" class="sidebar-link">编程之道</a></li><li><a href="/wiki/interview/java-0-基础.html" class="sidebar-link">Java基础</a></li><li><a href="/wiki/interview/java-1-数据结构和算法.html" class="sidebar-link">基本概念</a></li><li><a href="/wiki/interview/java-2-JVM.html" class="sidebar-link">JVM</a></li><li><a href="/wiki/interview/java-3-线程.html" class="active sidebar-link">线程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wiki/interview/java-3-线程.html#基本概念" class="sidebar-link">基本概念</a></li><li class="sidebar-sub-header"><a href="/wiki/interview/java-3-线程.html#线程-2" class="sidebar-link">线程</a></li></ul></li><li><a href="/wiki/interview/java-4-网络编程.html" class="sidebar-link">NIO、BIO、AIO</a></li><li><a href="/wiki/interview/java-5-设计模式.html" class="sidebar-link">设计模式</a></li><li><a href="/wiki/interview/java-6-框架.html" class="sidebar-link">开源框架</a></li><li><a href="/wiki/interview/java-7-数据库.html" class="sidebar-link">数据库</a></li><li><a href="/wiki/interview/java-8-分布式.html" class="sidebar-link">分布式</a></li><li><a href="/wiki/interview/java-9-微服务.html" class="sidebar-link">微服务</a></li><li><a href="/wiki/interview/java-99-面试题目.html" class="sidebar-link">面试题目</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="线程"><a href="#线程" aria-hidden="true" class="header-anchor">#</a> 线程</h1> <h2 id="基本概念"><a href="#基本概念" aria-hidden="true" class="header-anchor">#</a> 基本概念</h2> <p>并行：多个线程可以同时执行，每一个时间段，可以有多个线程同时执行。</p> <p><img src="http://ww3.sinaimg.cn/large/006tNc79gy1g5etl48tdsj309806egls.jpg" alt=""></p> <p>并发：多个线程同时竞争一个位置，竞争到的才可以执行，每一个时间段只有一个线程在执行。</p> <p><img src="http://ww1.sinaimg.cn/large/006tNc79gy1g5etlcarplj308u06dweo.jpg" alt=""></p> <p>进程：是程序关于某数据集合上的一次运行活动，是系统进行资源分配和调度的基本单位，是程序的基本执行实体。</p> <p>线程：进程中并发的一个顺序执行的最小调度单元。</p> <p>并发原理：CPU分配时间片，多线程交替运行。宏观并行，微观串行。</p> <p>进程和线程的关系：</p> <p><img src="http://ww2.sinaimg.cn/large/006tNc79gy1g5etm4ypu2j30eo06sq4l.jpg" alt="这里写图片描述"></p> <p>进程间通信的方式：</p> <ul><li>信号</li> <li>文件</li> <li>管道</li> <li>共享内存区</li> <li>信号量</li> <li>消息</li> <li>socket</li></ul> <p><strong>线程间的协作</strong>：</p> <p>在一个进程中会出现多个线程会访问同一个内存区域，因此就需要使用一种线程间的协作手段来处理</p> <p><strong>线程的同步机制主要有：互斥量，信号量，条件变量</strong></p> <p><strong>互斥量 ：出现了mutex，就为互斥量，为锁机制</strong></p> <p>(1)、在一个lock(加锁)和unlock(解锁)之间，形成的叫做：<strong>临界区域</strong></p> <p><strong>线程同步</strong>：<strong>阻塞别人而完成自己（是不是就是让别人等等）。利用互斥量达到同步，使封锁区域最小化</strong></p> <p>(2)、加锁后，没有解锁————&gt;将发生阻塞(不能再进行加锁)</p> <p>(3)、利用互斥量，将程序执行的不确定顺序变为了确定性的顺序</p> <p><strong>线程间同步</strong>：</p> <p>锁机制：互斥锁、条件变量、信号量、读写锁</p> <p>互斥锁：提供了以排他方式数据结构被并发修改的方法</p> <p>读写锁：写锁优先抢占资源，读锁允许多个线程共同读共享数据，而写锁操作是互斥的</p> <p>条件变量：以原子方式阻塞进程，直到某个特定条件为真为止</p> <p>一般情况下：互斥锁起保护作用，条件变量和互斥锁一起使用</p> <p><strong>总结：线程间通信的目的主要用于线程同步，所以线程没有像进程通信中的用于数据交换的通信机制</strong></p> <h2 id="线程-2"><a href="#线程-2" aria-hidden="true" class="header-anchor">#</a> 线程</h2> <p>线程三要素：CPU、Date、Code</p> <p>多线程间堆空间共享，栈空间独立。堆存的是地址，栈存的是变量（如：局部变量）</p> <p>创建线程有 4 方式：继承 Thread+实现 Runnable+实现 Callable+线程池获得</p> <p>Thread对象代表一个线程。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">//表示新建一个线程对象，并不表示线程。</span>
<span class="token class-name">Tread</span> t<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>当调用<code>t.start();</code>才起动线程，当得到CPU时，就会执行线程t的方法体。</p> <p>多线程共同访问的同一个对象（临界资源），如果破坏了不可分割的操作（原子操作），就会造成数据不一致的情况。</p> <p>在java中，任何对象都有一个互斥锁标记，用来分配给线程。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">synchronized</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">//..同步代码块. .</span>
<span class="token punctuation">}</span>
</code></pre></div><p>对o（o是临界资源）加锁的同步代码块，哪个线程能拿到该对象（临界资源）的锁，哪个线程就能调用该对象（临界资源）的同步方法。退出同步代码块时，会自动释放o的锁标记。</p> <p>一个线程，可以同时拥有多个对象的锁标记</p> <p>在java中，任何对象都有一个锁池，用来存放等待该对象锁标记的线程，线程阻塞在对象锁池中时，不会释放其所拥有的其它对象的锁标记。</p> <p>在java中，任何对象都有一个等待队列，用来存放线程，</p> <p>线程t1对（让）o调用wait方法,必须放在对o加锁的同步代码块中!</p> <p>1、t1会释放其所拥有的所有锁标记;</p> <p>2、t1会进入o的等待队列</p> <p>​	t2对（让）o调用notify/notifyAll方法,也必须放在对o加锁的同步代码块中!</p> <p>​	会从o的等待队列中释放一个/全部线程，对t2毫无影响，t2继续执行。</p> <h1 id="并发"><a href="#并发" aria-hidden="true" class="header-anchor">#</a> 并发</h1> <ul><li><p>说说线程安全问题，什么是线程安全，如何保证线程安全</p></li> <li><p>重入锁的概念，重入锁为什么可以防止死锁</p></li> <li><p>产生死锁的四个条件</p> <p>互斥、请求与保持、不剥夺、循环等待</p></li> <li><p>如何检查死锁（通过jConsole检查死锁）</p></li> <li><p>volatile 实现原理（禁止指令重排、刷新内存）</p></li> <li><p>synchronized 实现原理（对象监视器）</p></li> <li><p>synchronized 与 lock 的区别</p></li> <li><p>AQS同步队列</p></li> <li><p>CAS无锁的概念、乐观锁和悲观锁</p></li> <li><p>常见的原子操作类</p></li> <li><p>什么是ABA问题，出现ABA问题JDK是如何解决的</p></li> <li><p>乐观锁的业务场景及实现方式</p></li> <li><p>Java 8并法包下常见的并发类</p></li> <li><p>偏向锁、轻量级锁、重量级锁、自旋锁的概念</p></li> <li><p>AtomicInteger底层实现原理；</p></li> <li><p>synchronized与ReentraLock哪个是公平锁；</p></li> <li><p>CAS机制会出现什么问题；</p></li> <li><p>用过并发包下边的哪些类；</p></li> <li><p>CopyOnWriteArrayList是什么；</p></li> <li><p>Java中有哪些同步方案</p> <p>重量级锁、显式锁、并发容器、并发同步器、CAS、volatile、AQS等</p></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/wiki/interview/java-2-JVM.html" class="prev">
          JVM
        </a></span> <span class="next"><a href="/wiki/interview/java-4-网络编程.html">
          NIO、BIO、AIO
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/wiki/assets/js/app.dd178f5a.js" defer></script><script src="/wiki/assets/js/2.9f273a62.js" defer></script><script src="/wiki/assets/js/31.dde8666e.js" defer></script>
  </body>
</html>
